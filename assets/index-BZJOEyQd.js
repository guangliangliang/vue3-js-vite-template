import{u as $,r as R,a as _,b as i,c as C,o as b,d as o,w as s,e as r,f as v,t as q,h as F,i as S,j as k,E as L,s as D,k as z}from"./index-BaJaAyi_.js";import{l as E}from"./logo-_P8HlvPZ.js";import{u as I,o as N,g as M,a as j}from"./user-CJb-cpVL.js";import"./role-Dxqyi0J-.js";const A={class:"login-container"},G={class:"top-title"},H=["src"],J=["textContent"],K={__name:"LoginForm",emits:["to-register"],setup(U,{emit:c}){const g=c,p=$(),l=I(),f=R(),n=_({username:"",password:""}),y=_({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),d=_({loginBtn:!1});function x(a){a.username=a.username.trim(),a.password=a.password.trim()}function u(){g("to-register")}function t(){f.value&&f.value.validate(async a=>{if(a){d.loginBtn=!0,x(n);try{const e=await N(n);if(console.log(e,"resres"),e.code===200){p.push("/home"),d.loginBtn=!1,L.success("登录成功"),D(`Bearer ${e.data}`);const m=await M({user_id:e.data});m.code===200&&l.updateUser(m.data)}else d.loginBtn=!1}catch{d.loginBtn=!1}}})}return(a,e)=>{const m=i("el-input"),w=i("el-form-item"),B=i("el-button"),h=i("el-form"),T=i("el-card");return b(),C("div",A,[o(T,{class:"login-card",shadow:"hover"},{default:s(()=>[r("div",G,[r("img",{src:v(E)},null,8,H),r("h1",{textContent:q(v(F))},null,8,J)]),o(h,{ref_key:"formRef",ref:f,model:n,rules:y,"label-width":"0px",onSubmit:S(t,["prevent"])},{default:s(()=>[o(w,{prop:"username"},{default:s(()=>[o(m,{modelValue:n.username,"onUpdate:modelValue":e[0]||(e[0]=V=>n.username=V),size:"large",placeholder:"请输入用户名","prefix-icon":"user"},null,8,["modelValue"])]),_:1}),o(w,{prop:"password"},{default:s(()=>[o(m,{modelValue:n.password,"onUpdate:modelValue":e[1]||(e[1]=V=>n.password=V),size:"large",placeholder:"请输入密码","show-password":"","prefix-icon":"lock"},null,8,["modelValue"])]),_:1}),o(w,null,{default:s(()=>[o(B,{size:"large",type:"primary",class:"login-button",loading:d.loginBtn,disabled:d.loginBtn,onClick:t},{default:s(()=>e[2]||(e[2]=[k(" 登录 ")])),_:1,__:[2]},8,["loading","disabled"]),o(B,{size:"large",class:"login-two-button",onClick:u},{default:s(()=>e[3]||(e[3]=[k(" 注册 ")])),_:1,__:[3]})]),_:1})]),_:1},8,["model","rules"]),e[4]||(e[4]=r("div",{class:"footer"},[r("div",{class:"links"},[r("a",{href:"#"},"帮助"),r("a",{href:"#"},"隐私"),r("a",{href:"#"},"条款")]),r("div",{class:"copyright"},"Copyright ©@2025 科技有限公司 管理系统服务")],-1))]),_:1,__:[4]})])}}},O={class:"login-container"},P={__name:"RegisterForm",emits:["to-login"],setup(U,{emit:c}){const g=c,p=R(),l=_({username:"",password:""}),f=_({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),n=_({loginBtn:!1});function y(u){u.username=u.username.trim(),u.password=u.password.trim()}const d=()=>{g("to-login")};function x(){p.value&&p.value.validate(async u=>{if(u){n.loginBtn=!0,y(l);try{(await j(l)).code===200&&L.success("注册成功"),n.loginBtn=!1}catch{n.loginBtn=!1}}})}return(u,t)=>{const a=i("el-input"),e=i("el-form-item"),m=i("el-button"),w=i("el-form"),B=i("el-card");return b(),C("div",O,[o(B,{class:"login-card",shadow:"hover"},{default:s(()=>[t[4]||(t[4]=r("div",{class:"top-title"},[r("h3",{textContent:"注册"})],-1)),o(w,{ref_key:"formRef",ref:p,model:l,rules:f,"label-width":"0px",onSubmit:S(x,["prevent"])},{default:s(()=>[o(e,{prop:"username"},{default:s(()=>[o(a,{modelValue:l.username,"onUpdate:modelValue":t[0]||(t[0]=h=>l.username=h),size:"large",placeholder:"请输入用户名","prefix-icon":"user"},null,8,["modelValue"])]),_:1}),o(e,{prop:"password"},{default:s(()=>[o(a,{modelValue:l.password,"onUpdate:modelValue":t[1]||(t[1]=h=>l.password=h),size:"large",placeholder:"请输入密码","show-password":"","prefix-icon":"lock"},null,8,["modelValue"])]),_:1}),o(e,null,{default:s(()=>[o(m,{size:"large",type:"primary",class:"login-button",loading:n.loginBtn,disabled:n.loginBtn,onClick:x},{default:s(()=>t[2]||(t[2]=[k(" 注册 ")])),_:1,__:[2]},8,["loading","disabled"]),o(m,{size:"large",class:"login-two-button",onClick:d},{default:s(()=>t[3]||(t[3]=[k(" 已有账号？去登录 ")])),_:1,__:[3]})]),_:1})]),_:1},8,["model","rules"])]),_:1,__:[4]})])}}},Q={class:"login-container"},ee={__name:"index",setup(U){const c=R(!0),g=()=>{c.value=!1},p=()=>{c.value=!0};return(l,f)=>(b(),C("div",Q,[c.value?(b(),z(v(K),{key:0,class:"p-20px h-auto m-auto lt-xl:rounded-3xl lt-xl:light:bg-white",onToRegister:g})):(b(),z(v(P),{key:1,class:"p-20px h-auto m-auto lt-xl:rounded-3xl lt-xl:light:bg-white",onToLogin:p}))]))}};export{ee as default};
